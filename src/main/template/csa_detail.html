<div ng-if="csa" class="csa-info">

 <p ng-if="csa.description">{{csa.description}}</p>

 <div ng-if="editableCsaInfo" class="row last-row-w-separator">
     <div class="col-md-2">
         <button class="btn btn-default" ng-click="editCsa()">Amministrazione GAS</button>
     </div>
 </div>

 <div class="panel panel-default" ng-if="csa.kitty.amount != undefined">
  <div class="panel-heading">
   <h3 class="panel-title">Cassa comune</h3>
  </div>
  <div class="panel-body">

   <p ng-if="csa.kitty.amount">Saldo in cassa comune: {{ csa.kitty.amount[0] | currency: csa.kitty.amount[1] }}.
    <button class="btn btn-default" ng-click="showAccount(csa.kitty.id)">Visualizza tutti i movimenti</button>
   </p>
   <p ng-if="csa.last_kitty_deposit">Ultimo versamento in cassa risalente al {{ csa.last_kitty_deposit.log_date | date }} registrato da {{ csa.last_kitty_deposit.first_name}} {{ csa.last_kitty_deposit.last_name }}.
    <button class="btn btn-default" ng-click="showTransaction([0,0,0,0,csa.last_kitty_deposit.tid])">Dettagli</button>
   </p>

   <div ng-if="editableMembershipFee">
    <button class="btn btn-default" ng-if="!viewChargeMembershipForm" ng-click="showChargeMembershipFeeForm(true)">Addebita quota di partecipazione</button>

    <form ng-if="viewChargeMembershipForm" name="membershipFeeForm">
     <div class="form-group">
      <label for="membership_fee">Quota di partecipazione</label>
      <input type="number" min="0" ng-model="csa.kitty.membership_fee" class="form-control" id="membership_fee" placeholder="TODO">
     </div>
     <div class="form-group">
      <label for="charge_description">Annotazioni</label>
      <input type="text" class="form-control" ng-model="csa.kitty.charge_description" id="charge_description" placeholder="">
     </div>
     <button class="btn btn-default" ng-click="chargeMembershipFee()">Conferma</button>
     <button class="btn btn-default" ng-click="showChargeMembershipFeeForm(false)">Annulla</button>
     <div ng-if="membershipFeeError">{{membershipFeeError}}.</div>
    </form>

   </div>

  </div>
 </div>

<!--
<h2>Ultimi movimenti in cassa comune</h2>
 <div ng-if="csa.kitty.movements" class="movements-syn">
  <div ng-repeat="mov in csa.kitty.movements" class="mov-row" ng-click="showTransaction(mov)">
    <div class="mov-data">{{ mov[1] | date:"shortDate" }}</div>
    <div class="mov-desc">{{ mov[0] }}</div>
    <div class="mov-amount">{{ mov[3] | currency : mov[5] }}</div>
  </div>
  <button ng-click="showAccount(csa.kitty.id)">dettagli</button>
 </div>
 <div ng-if="csa.kitty.movements != null && csa.kitty.movements.length == 0">
 Nessuno
 </div>
-->

 <div ng-if="movements" class="panel panel-default">
  <div class="panel-heading">
   <h3 class="panel-title">Ultimi movimenti sul tuo conto</h3>
  </div>
  <div class="panel-body">

   <h4 ng-show="personalAmount != null">Saldo personale: {{personalAmount[0] | currency : personalAmount[1] }}</h4>

   <div ng-if="movements" class="movements-syn">
    <table class="table table-hover">
     <tbody>
      <tr ng-repeat="mov in movements" ng-click="showTransaction(mov)">
       <td class="col-md-2">{{ mov[1] | date:"shortDate" }}</td>
       <td class="col-md-8">{{ mov[0] }}</td>
       <td class="col-md-2">{{ mov[3] | currency : mov[5] }}</td>
      </tr>
     </tbody>
    </table>
    <button class="btn btn-default" ng-click="showAccount(gassman.selectedAccount)">Elenco completo</button>
   </div>
   <div ng-if="movements != null && movements.length == 0">
    <p>Nessuno</p>
   </div>
  </div>
 </div>


</div>

<div ng-if="loadError">
 <p>Pagina non disponible: <span ng-repeat="msg in loadError">{{ msg }}</span>.</p>
</div>
